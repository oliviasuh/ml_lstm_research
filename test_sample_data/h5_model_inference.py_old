import numpy as np
from tensorflow.keras.models import load_model
import os
os.environ['CUDA_VISIBLE_DEVICES'] = '-1' 
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

import tensorflow as tf
import warnings

# Suppress TensorFlow warnings related to CUDA
tf.get_logger().setLevel('ERROR')
warnings.filterwarnings("ignore", category=UserWarning)

# Load the trained .h5 model
model = load_model('accident_detection_model.h5')

from tensorflow.keras.layers import Input

# Rebuild the model with the correct input size
model = tf.keras.Sequential([
#    Input(shape=(64, 64, 3)),  # New input shape
    Input(shape=(3, 7, 3)),  # New input shape
#     Conv2D(filters=16, kernel_size=(3, 3), activation='relu'),
    # (Other layers...)
])
model.summary()
# Prepare an example input (this should match your model's expected input shape)
# For example, assuming input is a vector with shape (1, 64, 64, 3) for image data
#example_input = np.random.rand(1, 64, 64, 3)  # Adjust according to your model input shape
example_input = tf.random.normal(1,3,7,4,3)

x_input_resized = tf.image.resize(example_input,(1,3, 7))
# Use the model to make predictions
#predictions = model.predict(example_input)
predictions = model.predict(x_input_resized)

# Display the predictions
print("Predictions:", predictions)
